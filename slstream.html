<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SL WebRTC Stream</title>
  <style>
    html, body { margin:0; padding:0; height:100%; overflow:hidden; background:#000 }
    #player { width:100%; height:100%; }
    #overlay {
      position:absolute; top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.6);
      display:flex; align-items:center; justify-content:center;
      color:white; font-family:sans-serif;
      font-size:1.2em; cursor:pointer;
      user-select:none;
      /* ensure it sits above the video */
      z-index:10;
    }
    #overlay.hidden { display:none; }
  </style>
  <!-- OvenPlayer script; adapt version or host locally if you must -->
  <script src="https://cdn.jsdelivr.net/npm/ovenplayer@0.13.0/dist/ovenplayer.min.js"></script>
</head>
<body>
  <div id="player"></div>
  <div id="overlay">▶ Click anywhere to enable sound</div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 1️⃣ Create the player, but start it muted
      var player = OvenPlayer.create('player', {
        sources: [{
          type: 'webrtc',
          file: 'webrtc://YOUR_OME_SERVER/YOUR_APP/YOUR_STREAM'
        }],
        autoPlay: true,
        muted: true,
        loop: true
      });

      // 2️⃣ Grab references
      var overlay = document.getElementById('overlay');
      var videoEl;

      // Once the underlying <video> is ready, stash it
      player.on('ready', function() {
        videoEl = player.getContainer().querySelector('video');
      });

      // 3️⃣ On first click, unmute and hide overlay
      overlay.addEventListener('click', function() {
        if (videoEl) {
          videoEl.muted = false;
          videoEl.volume = 1.0;
          // Optionally re-play to be sure
          videoEl.play().catch(()=>{});
        }
        overlay.classList.add('hidden');

        // 4️⃣ (Optional) Remember user choice so overlay never shows again
        try { localStorage.setItem('webrtcUnmuted', '1'); } catch(e){}
      });

      // 5️⃣ (Optional) Check if they’d unmuted before
      try {
        if (localStorage.getItem('webrtcUnmuted') === '1') {
          overlay.classList.add('hidden');
          player.on('ready', function() {
            videoEl.muted = false;
            videoEl.volume = 1.0;
          });
        }
      } catch(e){}
    });
  </script>
</body>
</html>
